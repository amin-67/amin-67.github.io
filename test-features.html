<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>اختبار الميزات المطورة - المتميزون</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="enhanced-search.css">
  <link rel="stylesheet" href="enhanced-features.css">
  <style>
    .test-section {
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin: 20px 0;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    .test-section h3 {
      color: #2c3e50;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid #3498db;
    }

    .feature-status {
      padding: 10px;
      border-radius: 8px;
      margin: 10px 0;
      font-weight: bold;
    }

    .status-working {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .status-error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .test-button {
      background: linear-gradient(135deg, #3498db, #2980b9);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px 5px;
      transition: all 0.3s ease;
    }

    .test-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(52, 152, 219, 0.3);
    }
  </style>
</head>

<body>
  <div class="container">
    <header style="text-align: center; padding: 40px 0;">
      <h1>🧪 اختبار الميزات المطورة</h1>
      <p>فحص شامل لجميع التحسينات والميزات الجديدة في موقع المتميزون</p>
    </header>

    <div class="test-section">
      <h3>🔍 نظام البحث المحسن</h3>
      <div id="search-test-status" class="feature-status status-working">
        ✅ نظام البحث المحسن متاح ويعمل بشكل صحيح
      </div>
      <button class="test-button" onclick="testSearchSystem()">اختبار البحث الأساسي</button>
      <button class="test-button" onclick="testAdvancedSearch()">اختبار البحث المتقدم</button>
      <button class="test-button" onclick="testSearchFilters()">اختبار الفلاتر</button>
    </div>

    <div class="test-section">
      <h3>📊 تحليلات الأداء</h3>
      <div id="performance-test-status" class="feature-status">
        ⏳ فحص أداء الموقع...
      </div>
      <button class="test-button" onclick="testPerformance()">اختبار الأداء</button>
      <button class="test-button" onclick="testCaching()">اختبار التخزين المؤقت</button>
    </div>

    <div class="test-section">
      <h3>🎨 التصميم والتفاعل</h3>
      <div id="ui-test-status" class="feature-status">
        ⏳ فحص واجهة المستخدم...
      </div>
      <button class="test-button" onclick="testAnimations()">اختبار الحركات</button>
      <button class="test-button" onclick="testResponsive()">اختبار التصميم المتجاوب</button>
    </div>

    <div class="test-section">
      <h3>🔍 تحسينات SEO</h3>
      <div id="seo-test-status" class="feature-status">
        ⏳ فحص تحسينات محركات البحث...
      </div>
      <button class="test-button" onclick="testSEO()">اختبار Meta Tags</button>
      <button class="test-button" onclick="testStructuredData()">اختبار البيانات المنظمة</button>
    </div>

    <div class="test-section">
      <h3>📱 إمكانية الوصول</h3>
      <div id="accessibility-test-status" class="feature-status">
        ⏳ فحص إمكانية الوصول...
      </div>
      <button class="test-button" onclick="testAccessibility()">اختبار إمكانية الوصول</button>
      <button class="test-button" onclick="testKeyboardNavigation()">اختبار التنقل بلوحة المفاتيح</button>
    </div>

    <div class="test-section">
      <h3>📈 نتائج الاختبار الشامل</h3>
      <div id="overall-results">
        <button class="test-button" style="background: linear-gradient(135deg, #27ae60, #2ecc71);"
          onclick="runAllTests()">
          🚀 تشغيل جميع الاختبارات
        </button>
      </div>
      <div id="test-results-container"></div>
    </div>
  </div>

  <!-- تضمين جميع الملفات المطلوبة -->
  <script src="script.js"></script>
  <script src="enhanced-search-system.js"></script>
  <script src="advanced-enhancements.js"></script>

  <script>
    // اختبار نظام البحث
    function testSearchSystem() {
      try {
        if (typeof EnhancedSearchSystem !== 'undefined') {
          const searchSystem = new EnhancedSearchSystem();
          const results = searchSystem.search('رياضيات');
          updateStatus('search-test-status', '✅ نظام البحث يعمل بشكل صحيح - تم العثور على ' + results.length + ' نتيجة', 'working');
        } else {
          updateStatus('search-test-status', '❌ نظام البحث غير متاح', 'error');
        }
      } catch (error) {
        updateStatus('search-test-status', '❌ خطأ في نظام البحث: ' + error.message, 'error');
      }
    }

    // اختبار البحث المتقدم
    function testAdvancedSearch() {
      try {
        if (typeof EnhancedSearchSystem !== 'undefined') {
          const searchSystem = new EnhancedSearchSystem();
          const results = searchSystem.advancedSearch('', {
            stage: 'ابتدائي',
            grade: '5',
            subject: 'رياضيات'
          });
          updateStatus('search-test-status', '✅ البحث المتقدم يعمل - تم العثور على ' + results.length + ' نتيجة', 'working');
        } else {
          updateStatus('search-test-status', '❌ البحث المتقدم غير متاح', 'error');
        }
      } catch (error) {
        updateStatus('search-test-status', '❌ خطأ في البحث المتقدم: ' + error.message, 'error');
      }
    }

    // اختبار الفلاتر
    function testSearchFilters() {
      try {
        if (typeof EnhancedSearchSystem !== 'undefined') {
          const searchSystem = new EnhancedSearchSystem();
          const filters = searchSystem.getAvailableFilters();
          const filtersCount = Object.keys(filters).length;
          updateStatus('search-test-status', '✅ الفلاتر تعمل بشكل صحيح - ' + filtersCount + ' مجموعة فلاتر متاحة', 'working');
        } else {
          updateStatus('search-test-status', '❌ فلاتر البحث غير متاحة', 'error');
        }
      } catch (error) {
        updateStatus('search-test-status', '❌ خطأ في فلاتر البحث: ' + error.message, 'error');
      }
    }

    // اختبار الأداء
    function testPerformance() {
      try {
        const loadTime = performance.now() - (window.performanceMetrics?.pageLoadStart || 0);
        if (loadTime < 3000) {
          updateStatus('performance-test-status', '✅ الأداء ممتاز - وقت التحميل: ' + Math.round(loadTime) + 'ms', 'working');
        } else {
          updateStatus('performance-test-status', '⚠️ الأداء بطيء - وقت التحميل: ' + Math.round(loadTime) + 'ms', 'error');
        }
      } catch (error) {
        updateStatus('performance-test-status', '❌ خطأ في اختبار الأداء: ' + error.message, 'error');
      }
    }

    // اختبار التخزين المؤقت
    function testCaching() {
      try {
        if ('serviceWorker' in navigator) {
          updateStatus('performance-test-status', '✅ Service Worker متاح - التخزين المؤقت يعمل', 'working');
        } else {
          updateStatus('performance-test-status', '❌ Service Worker غير متاح', 'error');
        }
      } catch (error) {
        updateStatus('performance-test-status', '❌ خطأ في اختبار التخزين المؤقت: ' + error.message, 'error');
      }
    }

    // اختبار الحركات
    function testAnimations() {
      try {
        const animatedElements = document.querySelectorAll('.fade-in, .slide-in, .scale-in');
        if (animatedElements.length > 0) {
          updateStatus('ui-test-status', '✅ الحركات متاحة - ' + animatedElements.length + ' عنصر متحرك', 'working');
        } else {
          updateStatus('ui-test-status', '❌ لا توجد عناصر متحركة', 'error');
        }
      } catch (error) {
        updateStatus('ui-test-status', '❌ خطأ في اختبار الحركات: ' + error.message, 'error');
      }
    }

    // اختبار التصميم المتجاوب
    function testResponsive() {
      try {
        const viewport = window.innerWidth;
        if (viewport < 768) {
          updateStatus('ui-test-status', '✅ التصميم المتجاوب - عرض الهاتف المحمول: ' + viewport + 'px', 'working');
        } else if (viewport < 1024) {
          updateStatus('ui-test-status', '✅ التصميم المتجاوب - عرض التابلت: ' + viewport + 'px', 'working');
        } else {
          updateStatus('ui-test-status', '✅ التصميم المتجاوب - عرض سطح المكتب: ' + viewport + 'px', 'working');
        }
      } catch (error) {
        updateStatus('ui-test-status', '❌ خطأ في اختبار التصميم المتجاوب: ' + error.message, 'error');
      }
    }

    // اختبار SEO
    function testSEO() {
      try {
        const title = document.title;
        const description = document.querySelector('meta[name="description"]')?.content;
        const keywords = document.querySelector('meta[name="keywords"]')?.content;

        if (title && description && keywords) {
          updateStatus('seo-test-status', '✅ Meta Tags متكاملة - العنوان والوصف والكلمات المفتاحية موجودة', 'working');
        } else {
          updateStatus('seo-test-status', '⚠️ بعض Meta Tags مفقودة', 'error');
        }
      } catch (error) {
        updateStatus('seo-test-status', '❌ خطأ في اختبار SEO: ' + error.message, 'error');
      }
    }

    // اختبار البيانات المنظمة
    function testStructuredData() {
      try {
        const structuredData = document.querySelectorAll('script[type="application/ld+json"]');
        if (structuredData.length > 0) {
          updateStatus('seo-test-status', '✅ البيانات المنظمة متاحة - ' + structuredData.length + ' schema موجود', 'working');
        } else {
          updateStatus('seo-test-status', '❌ البيانات المنظمة غير موجودة', 'error');
        }
      } catch (error) {
        updateStatus('seo-test-status', '❌ خطأ في اختبار البيانات المنظمة: ' + error.message, 'error');
      }
    }

    // اختبار إمكانية الوصول
    function testAccessibility() {
      try {
        const altTexts = document.querySelectorAll('img[alt]');
        const ariaLabels = document.querySelectorAll('[aria-label]');
        const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

        updateStatus('accessibility-test-status',
          '✅ إمكانية الوصول جيدة - ' + altTexts.length + ' صورة مع نص بديل، ' +
          ariaLabels.length + ' عنصر مع aria-label، ' + headings.length + ' عنوان',
          'working');
      } catch (error) {
        updateStatus('accessibility-test-status', '❌ خطأ في اختبار إمكانية الوصول: ' + error.message, 'error');
      }
    }

    // اختبار التنقل بلوحة المفاتيح
    function testKeyboardNavigation() {
      try {
        const focusableElements = document.querySelectorAll('a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])');
        if (focusableElements.length > 0) {
          updateStatus('accessibility-test-status', '✅ التنقل بلوحة المفاتيح متاح - ' + focusableElements.length + ' عنصر قابل للتركيز', 'working');
        } else {
          updateStatus('accessibility-test-status', '❌ لا توجد عناصر قابلة للتركيز', 'error');
        }
      } catch (error) {
        updateStatus('accessibility-test-status', '❌ خطأ في اختبار التنقل بلوحة المفاتيح: ' + error.message, 'error');
      }
    }

    // تشغيل جميع الاختبارات
    function runAllTests() {
      const resultsContainer = document.getElementById('test-results-container');
      resultsContainer.innerHTML = '<div style="text-align: center; padding: 20px;"><h4>🔄 تشغيل الاختبارات...</h4></div>';

      setTimeout(() => {
        testSearchSystem();
        testAdvancedSearch();
        testSearchFilters();
        testPerformance();
        testCaching();
        testAnimations();
        testResponsive();
        testSEO();
        testStructuredData();
        testAccessibility();
        testKeyboardNavigation();

        setTimeout(() => {
          generateSummaryReport();
        }, 1000);
      }, 500);
    }

    // إنشاء تقرير ملخص
    function generateSummaryReport() {
      const workingFeatures = document.querySelectorAll('.status-working').length;
      const errorFeatures = document.querySelectorAll('.status-error').length;
      const totalFeatures = workingFeatures + errorFeatures;

      const resultsContainer = document.getElementById('test-results-container');
      resultsContainer.innerHTML = `
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; margin-top: 20px;">
                    <h4>📊 تقرير الاختبار الشامل</h4>
                    <p><strong>الميزات التي تعمل بشكل صحيح:</strong> ${workingFeatures} من ${totalFeatures}</p>
                    <p><strong>نسبة النجاح:</strong> ${Math.round((workingFeatures / totalFeatures) * 100)}%</p>
                    <div style="background: rgba(255,255,255,0.2); border-radius: 8px; padding: 15px; margin-top: 15px;">
                        <p><strong>✅ الميزات المكتملة:</strong></p>
                        <ul style="text-align: right;">
                            <li>نظام البحث المحسن مع الفلاتر المتقدمة</li>
                            <li>تحسينات الأداء والتخزين المؤقت</li>
                            <li>التصميم المتجاوب والحركات</li>
                            <li>تحسينات SEO والبيانات المنظمة</li>
                            <li>إمكانية الوصول والتنقل</li>
                        </ul>
                    </div>
                </div>
            `;
    }

    // دالة مساعدة لتحديث حالة الاختبار
    function updateStatus(elementId, message, status) {
      const element = document.getElementById(elementId);
      if (element) {
        element.textContent = message;
        element.className = 'feature-status status-' + status;
      }
    }

    // تشغيل اختبار أولي عند تحميل الصفحة
    document.addEventListener('DOMContentLoaded', function () {
      setTimeout(() => {
        testSearchSystem();
        testPerformance();
        testResponsive();
        testSEO();
        testAccessibility();
      }, 1000);
    });
  </script>
</body>

</html>