document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){const e=document.getElementById("loader");e&&(e.style.opacity="0",setTimeout(function(){e.style.display="none"},500))},2e3);function e(e,t,n=2e3){const r=0,i=t/(n/16);let o=r;const a=setInterval(function(){o+=i,o>=t&&(o=t,clearInterval(a)),e.textContent=Math.floor(o)},16)}const t=new IntersectionObserver(function(n){n.forEach(function(n){if(n.isIntersecting){const r=parseInt(n.target.getAttribute("data-target"));e(n.target,r),t.unobserve(n.target)}})});document.querySelectorAll(".stat-number").forEach(function(e){t.observe(e)});const n=document.querySelectorAll(".content-card"),r=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&e.target.classList.add("reveal")})});n.forEach(function(e){r.observe(e)});const i=document.querySelectorAll(".testimonial-item"),o=document.querySelectorAll(".testimonial-indicator");let a=0;function s(e){i.forEach((e,t)=>{e.classList.remove("active")}),o.forEach((e,t)=>{e.classList.remove("active")}),i[e].classList.add("active"),o[e].classList.add("active")}function c(){a>=i.length-1?a=0:a++,s(a)}let l=setInterval(c,5e3);o.forEach((e,t)=>{e.addEventListener("click",()=>{clearInterval(l),a=t,s(a),l=setInterval(c,5e3)})});const d=document.querySelector(".back-to-top");window.addEventListener("scroll",function(){window.scrollY>500?d.classList.add("visible"):d.classList.remove("visible")}),d.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})});const u=document.querySelector(".mobile-menu-btn"),m=document.querySelector(".nav-menu");u&&u.addEventListener("click",function(){m.classList.toggle("mobile-active")});document.querySelector(".theme-toggle")?.addEventListener("click",function(){document.body.classList.toggle("dark-mode"),localStorage.setItem("dark-mode",document.body.classList.contains("dark-mode"))});if(localStorage.getItem("dark-mode")==="true"){document.body.classList.add("dark-mode")}const f=document.querySelector(".books-carousel"),v=document.querySelectorAll(".carousel-dot"),h=document.querySelector(".prev-button"),g=document.querySelector(".next-button");let p=0;function b(e){const t=document.querySelectorAll(".book-card")[e].offsetLeft-f.offsetLeft;f.scrollTo({left:t,behavior:"smooth"}),v.forEach(e=>e.classList.remove("active")),v[e].classList.add("active")}if(f){h?.addEventListener("click",function(){p=p<=0?0:p-1,b(p)});g?.addEventListener("click",function(){p=p>=v.length-1?v.length-1:p+1,b(p)});v.forEach((e,t)=>{e.addEventListener("click",function(){p=t,b(p)})});let e=0,t=0;const n=20;function r(r){if(f.scrollLeft){const i=r.clientX-e;if(Math.abs(i)>n){f.scrollLeft=t-i}}else{const e=r.touches[0].clientX-t;if(Math.abs(e)>n){f.scrollLeft=i-e}}}f.addEventListener("mousedown",function(t){f.style.scrollBehavior="auto",e=t.clientX,i=f.scrollLeft,document.addEventListener("mousemove",r),document.addEventListener("mouseup",o)});f.addEventListener("touchstart",function(e){f.style.scrollBehavior="auto",t=e.touches[0].clientX,i=f.scrollLeft,f.addEventListener("touchmove",r),f.addEventListener("touchend",a)});function i(){document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",i),setTimeout(()=>{f.style.scrollBehavior="smooth"},10);const e=Math.round(f.scrollLeft/f.offsetWidth);p=Math.min(Math.max(e,0),v.length-1),b(p)}function o(){f.removeEventListener("touchmove",r),f.removeEventListener("touchend",o),setTimeout(()=>{f.style.scrollBehavior="smooth"},10);const e=Math.round(f.scrollLeft/f.offsetWidth);p=Math.min(Math.max(e,0),v.length-1),b(p)}}const y=document.querySelector(".search-icon"),L=document.querySelector(".search-box"),E=document.querySelector(".search-form"),w=document.querySelector(".search-input"),S=document.querySelector(".search-results");y?.addEventListener("click",function(){L.classList.toggle("active")});const q=[{title:"الرياضيات للصف الثالث الثانوي",author:"د. محمد أحمد",category:"ثانوية عامة",description:"كتاب شامل في الرياضيات للصف الثالث الثانوي يغطي المنهج كاملاً مع شرح مفصل وحلول نموذجية.",pages:250,date:"2023-05-15",rating:4.8,link:"https://t.me/aminsayed_books/1"},{title:"الفيزياء للصف الثاني الثانوي",author:"أ. أحمد محمود",category:"ثانوية عامة",description:"مذكرة متميزة في الفيزياء للصف الثاني الثانوي تحتوي على شرح مبسط وتدريبات متنوعة.",pages:180,date:"2023-04-10",rating:4.5,link:"https://t.me/aminsayed_books/2"},{title:"اللغة الإنجليزية للصف الأول الثانوي",author:"أ. سارة خالد",category:"ثانوية عامة",description:"كتاب اللغة الإنجليزية للصف الأول الثانوي يشمل شرح القواعد وتدريبات على القراءة والكتابة.",pages:150,date:"2023-03-22",rating:4.7,link:"https://t.me/aminsayed_books/3"},{title:"العلوم للصف السادس الابتدائي",author:"د. هبة محمد",category:"ابتدائي",description:"كتاب مبسط في العلوم للصف السادس الابتدائي مع رسومات توضيحية وأنشطة تفاعلية.",pages:120,date:"2023-06-05",rating:4.9,link:"https://t.me/aminsayed_books/4"},{title:"الدراسات الاجتماعية للصف الثالث الإعدادي",author:"أ. محمود علي",category:"إعدادي",description:"مذكرة شاملة في الدراسات الاجتماعية للصف الثالث الإعدادي مع خرائط توضيحية وأسئلة متنوعة.",pages:160,date:"2023-02-18",rating:4.3,link:"https://t.me/aminsayed_books/5"},{title:"الكيمياء للصف الثالث الثانوي",author:"د. أحمد فؤاد",category:"ثانوية عامة",description:"كتاب متميز في الكيمياء للصف الثالث الثانوي يشرح المفاهيم بطريقة مبسطة مع حل تمارين.",pages:220,date:"2023-01-30",rating:4.6,link:"https://t.me/aminsayed_books/6"},{title:"اللغة العربية للصف الثاني الإعدادي",author:"أ. فاطمة محمد",category:"إعدادي",description:"مذكرة في اللغة العربية للصف الثاني الإعدادي تشمل النحو والبلاغة والنصوص الأدبية.",pages:140,date:"2023-07-12",rating:4.4,link:"https://t.me/aminsayed_books/7"},{title:"الرياضيات للصف الخامس الابتدائي",author:"أ. سمير حسن",category:"ابتدائي",description:"كتاب مبسط في الرياضيات للصف الخامس الابتدائي مع أمثلة محلولة وتدريبات متنوعة.",pages:100,date:"2023-08-20",rating:4.8,link:"https://t.me/aminsayed_books/8"},{title:"الأحياء للصف الأول الثانوي",author:"د. منى أحمد",category:"ثانوية عامة",description:"مذكرة شاملة في الأحياء للصف الأول الثانوي مع رسومات توضيحية وتلخيص للمنهج.",pages:170,date:"2023-09-05",rating:4.7,link:"https://t.me/aminsayed_books/9"},{title:"اللغة الفرنسية للصف الثاني الثانوي",author:"أ. نادية سمير",category:"ثانوية عامة",description:"كتاب متميز في اللغة الفرنسية للصف الثاني الثانوي يشمل القواعد والمحادثة والتدريبات.",pages:130,date:"2023-10-15",rating:4.5,link:"https://t.me/aminsayed_books/10"}];function k(e){S.innerHTML="";if(e.length===0){S.innerHTML='<div class="no-results">لا توجد نتائج مطابقة للبحث</div>';return}e.forEach(e=>{const t=document.createElement("div");t.className="search-result-item";t.innerHTML=`
        <h4>${e.title}</h4>
        <p>${e.author} - ${e.category}</p>
    `;t.addEventListener("click",()=>{window.open(e.link,"_blank")}),S.appendChild(t)})}E?.addEventListener("submit",function(e){e.preventDefault();const t=w.value.trim().toLowerCase();if(!t){S.innerHTML="";return}const n=q.filter(e=>e.title.toLowerCase().includes(t)||e.author.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.category.toLowerCase().includes(t));k(n)});const T=document.querySelector(".add-review-btn"),I=document.querySelector(".modal-overlay"),A=document.querySelector(".modal-close"),B=document.querySelector(".review-form");T?.addEventListener("click",function(){I.classList.add("active"),document.body.style.overflow="hidden"});A?.addEventListener("click",function(){I.classList.remove("active"),document.body.style.overflow=""});I?.addEventListener("click",function(e){e.target===I&&(I.classList.remove("active"),document.body.style.overflow="")});B?.addEventListener("submit",function(e){e.preventDefault();const t=document.querySelector('input[name="rating"]:checked').value,n=document.querySelector('input[name="reviewer-name"]').value,r=document.querySelector('textarea[name="review-text"]').value,i=document.querySelector('select[name="book-title"]').value,o=new Date().toLocaleDateString("ar-EG"),a=document.createElement("div");a.className="review-card";a.innerHTML=`
        <div class="review-header">
            <div class="reviewer-info">
                <div class="reviewer-avatar">${n.charAt(0)}</div>
                <div class="reviewer-details">
                    <h4>${n}</h4>
                    <div class="reviewer-date">${o}</div>
                </div>
            </div>
            <div class="review-book-info">
                <strong>كتاب</strong>
                ${i}
            </div>
        </div>
        <div class="review-rating">
            ${Array(5).fill().map((_,e)=>`<i class="star fa${e<t?"s":"r"} fa-star"></i>`).join("")}
        </div>
        <div class="review-content">
            <p>${r}</p>
        </div>
        <div class="review-actions">
            <div class="review-reaction">
                <button class="reaction-btn">
                    <i class="fas fa-thumbs-up"></i> إعجاب
                </button>
                <button class="reaction-btn">
                    <i class="fas fa-comment"></i> تعليق
                </button>
            </div>
        </div>
    `;document.querySelector(".reviews-list").prepend(a),I.classList.remove("active"),document.body.style.overflow="",B.reset()})});document.addEventListener("DOMContentLoaded",function(){if(!"IntersectionObserver"in window){document.querySelectorAll(".content-card").forEach(function(e){e.classList.add("reveal")})}});window.addEventListener("load",function(){document.getElementById("particles-js")&&particlesJS("particles-js",{particles:{number:{value:80,density:{enable:true,value_area:800}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"},polygon:{nb_sides:5}},opacity:{value:.5,random:true},size:{value:3,random:true},line_linked:{enable:true,distance:150,color:"#ffffff",opacity:.4,width:1},move:{enable:true,speed:6,direction:"none",random:true,straight:false,out_mode:"out",bounce:false}}})});
